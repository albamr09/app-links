<html>
  <head>
    <title>Map</title>
    <script>
      function redirectMap() {
        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', redirectMap);
          return;
        }

        // Get query parameters from current URL
        const urlParams = new URLSearchParams(window.location.search);
        
        // Build the redirect URL with profile as path
        const redirectUrl = new URL('https://maps.situm.com');

        // Get the profile from the path
        const pathSegments = window.location.pathname.split('/').filter(Boolean);
        const mapIndex = pathSegments.indexOf('map');
        const profile = mapIndex >= 0 && pathSegments[mapIndex + 1] 
          ? pathSegments[mapIndex + 1] 
          : 'z_core'; // fallback to default
        redirectUrl.pathname = '/' + profile;
        
        // Copy all query parameters from the original URL
        urlParams.forEach((value, key) => {
          redirectUrl.searchParams.set(key, value);
        });

        console.log({ redirectUrl });

        const mapviewFrame = document.getElementById("map-viewer-iframe");
        if (mapviewFrame) {
          mapviewFrame.src = redirectUrl.toString();
        }
      };

      // Execute the redirect when DOM is ready
      redirectMap();
    </script>
  </head>
  <body style="margin: 0">
    <iframe
        id="map-viewer-iframe"
        style="width:100vw; height:100vh; border: unset"
        src="https://maps.situm.com">
    </iframe>
  </body>
</html>

